<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Sean W. D. Turner and Stefano Galelli" />


<title>How to determine the no-fail capacity of a water supply reservoir using sequent peak analysis in R</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div class="fluid-row" id="header">


<h1 class="title">How to determine the no-fail capacity of a water supply reservoir using sequent peak analysis in R</h1>
<h3 class="subtitle"><em>A tutorial from the series ‘Learn hydrology and water resources systems analysis with R’</em></h3>
<h4 class="author"><em>Sean W. D. Turner<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> and Stefano Galelli<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></em></h4>

</div>


<p><strong>How to cite:</strong> Turner, S. W. D. &amp; Galelli, S. (2016). How to determine the no-fail capacity of a water supply reservoir using sequent peak analysis in R. <em>Learn hydrology and water resources systems analysis with R</em>.</p>
<div id="learn-to" class="section level3">
<h3><em>Learn to:</em></h3>
<ul>
<li><p><em>Perform sequent peak analysis in R to determine the no-fail capacity of a reservoir</em></p></li>
<li><p><em>Apply the <code>Rippl</code> function in R package <code>reservoir</code></em></p></li>
<li><p><em>Generate the distribution of the no-fail capacity to account for hydrological uncertainty</em></p></li>
<li><p><em>Examine the spill from the reservoir to assess impacts on the downstream river system</em></p></li>
</ul>
</div>
<div id="why-determine-the-no-fail-capacity-of-a-reservoir" class="section level2">
<h2>Why determine the no-fail capacity of a reservoir?</h2>
<blockquote>
<p>“Hence reservoirs were constructed of insufficient size, causing a sensible deficiency in the water-supply in dry seasons. As the dams of the storage-reservoirs could not be raised in height without endangering their stability, new reservoirs and new gathering grounds had to be added—a proceeding sometimes difficult and always costly.” — <strong><em>Wenzel Rippl (1883)</em></strong></p>
</blockquote>
<p>The construction of a dam or reservoir for water supply is normally a major undertaking, requiring substantial financial outlay and causing significant environmental impacts, such as loss of land. Once the dam is built, there is not a lot that can be done to redesign it; the capital costs are sunk and the impacts irreversible. It is therefore critically important to get the design right—or at least roughly right—so the project fulfils its function without incurring unnecessary additional costs or impacts. Before detailed dam design can take place, engineers need to know the required storage capacity, since it is stored water that enables a reservoir to keep supplying a constant flow of water to users during drought. Larger storage capacity allows for a larger constant supply, or <strong><em>yield</em></strong>, although large yield also implies less water released back to the environment—an increasingly important consideration in reservoir planning.</p>
<p>This tutorial will teach you how to code a simple, effective, popular algorithm—known as the sequent peak algorithm—for determining the <strong><em>no-fail capacity</em></strong> of a reservoir with a specified target yield. You’ll learn how to code the algorithm, how to save time by implementing the <code>Rippl</code> function, how to make the design capacity more robust by accounting for hydrological uncertainty, and how to examine the impact of different designs on flows to the downstream river system. You’ll also learn about the limitations of the sequent peak algorithm and the alternative approaches to designing a water supply system.</p>
</div>
<div id="the-sequent-peak-algorithm" class="section level2">
<h2>The sequent peak algorithm</h2>
<p>Back in the late 19th century, an English engineer named Wenzel Rippl formulated what was probably the first analytically rigorous method for determining how large a reservoir should be to meet a demand for water without failure (the term “no-fail storage” is thus used interchangably with “Rippl storage”). Failure in this sense means that the target demand is not met in full, which occurs if the reservoir empties. It’s hard to envisage how reservoirs would have been designed before the 20th century, because engineers would have lacked the observational records of rainfall and streamflow that today’s hydrologists can take for granted in most parts of the world (the above quote from Rippl seems to suggest that reservoirs were routinely underdesigned and so new reservoirs had to be built at great cost). Rippl’s graphical approach was known as the “Mass Curve method,” and it was used to design reservoirs and dams in many parts of the world during the early 20th century. The advent of computers enabled more efficent methods for computing the same thing—including simulation approaches, such as <strong><em>sequent peak analysis</em></strong> (or the <strong><em>sequent peak algorithm</em></strong>).</p>
<p>Sequent peak analysis uses the mass balance equation to simulate the storage behavior of a reservoir with undefined capacity. The storage behavior depends on two variables: the net inflows to the reservoir <span class="math inline">\(Q\)</span> and the releases from the reservoir <span class="math inline">\(R\)</span>. Simple conservation of mass dictates that the volume of stored water in a reservoir <span class="math inline">\(S\)</span> at time <span class="math inline">\(t+1\)</span> must equal the storage at time <span class="math inline">\(t\)</span> plus the net inflows <span class="math inline">\(Q_t\)</span> minus the release <span class="math inline">\(R_t\)</span>:</p>
<p><span class="math display">\[ S_t = S_{t+1} + Q_t - R_t \]</span></p>
<p>This is subject to the basic constraint that says the minimum volume of water in storage is zero and the maximum equal to the capacity of the reservior:</p>
<p><span class="math display">\[ 0 \leq S \leq S_{cap} \]</span></p>
<p>Since the reservoir can run out of water, the release <span class="math inline">\(R\)</span> is also be constrained to a maximum of water available in storage <span class="math inline">\(S_t\)</span> plus incoming water <span class="math inline">\(Q_t\)</span> (you can only release what you’ve got in storage plus whatever inflow entering the system):</p>
<p><span class="math display">\[ 0 \leq R_t \leq S_t + Q_t \]</span></p>
<p>We do not need to worry about the release constraint when conducting sequent peak analysis, because we are designing for the reservoir capacity that never fails to deliver the target release.</p>
<p>We begin by assuming that the capacity is infinite. We then create a new variable, <span class="math inline">\(K\)</span>, which behaves like storage, but is inverted such that <span class="math inline">\(K_{t+1}\)</span> is equal to <span class="math inline">\(K_t\)</span> <em>plus</em> the release <em>minus</em> the inflows. The reservoir is then at maximum capacity when <span class="math inline">\(K\)</span> = 0, so the capacity constraint is represented by setting <span class="math inline">\(K_{t+1} = 0\)</span> if <span class="math inline">\((K_t + R_t - Q_t)\)</span> is negative.</p>
<p><span class="math display">\[ K_{t+1} = max(K_t - Q_t + R, 0) \]</span></p>
<p>The no fail storage capacity <span class="math inline">\(S_{cap}\)</span> is then equal to maximum <span class="math inline">\(K\)</span> computed in the simulation. Note that we are assuming a constant yield target, meaning the release <span class="math inline">\(R\)</span> does not vary with time. Often it is prudent to <strong><em>double-cycle</em></strong> the inflow sequence before executing the sequent peak analysis (i.e., repeat the algorithm over two successive cycles of the inflow sequence). Doing this helps avoid undersizing of the reservoir in the event that <span class="math inline">\(K &gt; 0\)</span> at the end of the first cycle (meaning the reservoir is below capacity and simulation should continue in case the capacity needs to be larger to ensure no failure).</p>
</div>
<div id="example-application-in-r" class="section level2">
<h2>Example application in R</h2>
<p>To begin the following example, you’ll need the observed streamflow record from the Tygarts Creek near Greenup, Kentucky. Let’s assume that you’ve been contracted to determine the size of a new planned reservoir, to be sited just downstream of the streamflow station. The desired yield is 250 million cubic metres per year.</p>
<p>The streamflow data for this station can be obtained from the <a href="http://waterdata.usgs.gov/or/nwis/uv/?site_no=03217000">US Geological Survey</a>. The easiest way to get it is to use the USGS R package <code>dataRetrieval</code>, which was created specifically to simplify the process of loading USGS hydrological data into the R environment. You can download the package by entering the command <code>install.packages(&quot;dataRetrieval&quot;)</code> and then use the <code>readNWISdv</code> function to download the streamflow data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Q_raw &lt;-<span class="st"> </span>dataRetrieval::<span class="kw">readNWISdv</span>(<span class="st">&quot;03217000&quot;</span>, <span class="st">&quot;00060&quot;</span>)
<span class="co"># Note: the use of &quot;::&quot; saves us from having to load dataRetrieval separately.</span>
<span class="kw">head</span>(Q_raw)  <span class="co"># The head() function shows the first five or six rows of data.</span></code></pre></div>
<pre><code>##   agency_cd  site_no       Date X_00060_00003 X_00060_00003_cd
## 1      USGS 03217000 1940-08-05          12.0                A
## 2      USGS 03217000 1940-08-06          12.0                A
## 3      USGS 03217000 1940-08-07          10.0                A
## 4      USGS 03217000 1940-08-08           9.8                A
## 5      USGS 03217000 1940-08-09           8.7                A
## 6      USGS 03217000 1940-08-10           6.8                A</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Column 4 gives the streamflow in cubic feet per second.</span></code></pre></div>
<p>For many water resources applications, and for the purposes of this tutorial, daily resolution data is finer than is necessary. If we want to get the no-fail capacity for a large, over-year reservoir, then montly or annual data will usually suffice. Here we’ll convert to annual data. The quickest way I’ve found to do this is to first convert the daily series data to an <code>zoo</code> object and then <code>aggregate</code> to annual resolution using the date index of the zoo object. Start by installing <code>zoo</code>: <code>install.packages(&quot;zoo&quot;)</code>. Then use the flow data (column 4) and corresponding dates (column 3) from the downloaded data frame to transform into a single daily time series:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(zoo)
Q_daily &lt;-<span class="st"> </span><span class="kw">zoo</span>(Q_raw[,<span class="dv">4</span>], <span class="dt">order.by =</span> Q_raw[,<span class="dv">3</span>]) <span class="co"># convert to zoo object</span>
Q_daily &lt;-<span class="st"> </span>Q_daily *<span class="st"> </span><span class="fl">0.0283168466</span> <span class="co"># convert cubic ft /s to cubic m /s.</span>
Q_daily &lt;-<span class="st"> </span>Q_daily *<span class="st"> </span><span class="dv">60</span> *<span class="st"> </span><span class="dv">60</span> *<span class="st"> </span><span class="dv">24</span> /<span class="st"> </span><span class="dv">1000000</span> <span class="co"># convert to daily totals (Mm^3)</span>
Q_annual &lt;-<span class="st"> </span><span class="kw">aggregate</span>(Q_daily, <span class="dt">by =</span> <span class="kw">format</span>(<span class="kw">index</span>(Q_daily), <span class="st">&quot;%Y&quot;</span>), <span class="dt">FUN =</span> sum) <span class="co">#annualize</span>
Q &lt;-<span class="st"> </span><span class="kw">as.ts</span>(Q_annual) <span class="co"># convert to a time-series object</span>
Q &lt;-<span class="st"> </span><span class="kw">window</span>(Q, <span class="dt">start =</span> <span class="kw">start</span>(Q) +<span class="st"> </span><span class="dv">1</span>, <span class="dt">end =</span> <span class="kw">end</span>(Q) -<span class="st"> </span><span class="dv">1</span>) <span class="co"># snip the first and last years</span>
<span class="kw">plot</span>(Q, <span class="dt">ylab =</span> <span class="st">&quot;Q totals (Mm^3)&quot;</span>) <span class="co"># view the annual series</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
<p>Don’t worry if any of the above code confuses you. With time and experience you’ll soon learn how to handle the various time series data types and functions. The important point is that we now have <span class="math inline">\(Q\)</span> in a suitable form for the sequent peak algorithm, which is annual inflow totals.</p>
<p>Since the desired yield is 250 million cubic metres per year, we set the release variable <span class="math inline">\(R\)</span> to 250:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R &lt;-<span class="st"> </span><span class="dv">250</span> <span class="co"># required annual yield in million cubic metres per year.</span></code></pre></div>
<p>Next we want to set up a blank vector for <span class="math inline">\(K\)</span>, which will be populated during the simulation. We make <span class="math inline">\(K\)</span> one year longer than <span class="math inline">\(Q\)</span> so that the simulation can resolve the final timestep <span class="math inline">\(K_{t+1}\)</span> for the last year of inflow. We set the initial storage to full capacity by setting <span class="math inline">\(K_1 = 0\)</span> then simulate using a <code>for</code> loop. The no-fail capacity is the maximum of <span class="math inline">\(K\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">K &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(Q) +<span class="st"> </span><span class="dv">1</span>) <span class="co"># set up vector K with length = length + 1</span>
K[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># set initial K to zero</span>
for (t in <span class="dv">1</span>:<span class="kw">length</span>(Q)) {
  K[t +<span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">max</span>(R -<span class="st"> </span>Q[t] +<span class="st"> </span>K[t], <span class="dv">0</span>)
}
K &lt;-<span class="st"> </span><span class="kw">ts</span>(K[<span class="dv">1</span>:<span class="kw">length</span>(K) -<span class="st"> </span><span class="dv">1</span>], <span class="dt">start =</span> <span class="kw">start</span> (Q), <span class="dt">frequency =</span> <span class="kw">frequency</span>(Q))
S_cap &lt;-<span class="st"> </span><span class="kw">max</span>(K)
<span class="kw">plot</span>(K, <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;No-fail capacity = &quot;</span>, <span class="kw">round</span>(S_cap, <span class="dv">0</span>), <span class="st">&quot; Mm^3&quot;</span>))
<span class="kw">abline</span>(<span class="dt">h =</span> S_cap, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="co"># add no-fail capacity line to plot</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
<p>If we want to look at the storage behavior we simply take the negative of <span class="math inline">\(K\)</span> and add <span class="math inline">\(S_{cap}\)</span> to the entire time series:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S &lt;-<span class="st"> </span>K *<span class="st"> </span>(-<span class="dv">1</span>) +<span class="st"> </span>S_cap
<span class="kw">plot</span>(S, <span class="dt">ylab =</span> <span class="st">&quot;Stored water (Mm^3)&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Storage behavior diagram&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> S_cap, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="co"># add no-fail capacity line to plot</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAEgCAMAAABcujGyAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OpA6kNtmAABmADpmAGZmtrZmtv+QOgCQZgCQkGaQtpCQ2/+2ZgC2Zma2/7a2///bkDrb2//b////tmb/25D//7b//9v///8HcgKmAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATLklEQVR4nO2dgZqbOLJGScc92d3uuevsbtgJN+6O3/8lFyEkBAhJJZVwYf7zfTNxg1wl8LGQBIbmDoBgmkdXAIAQEBSIBoIC0UBQIBoICkQDQYFoICgQDQQFooGgQDQQFIgGggLRQFAgGggKRANBgWggKBANBAWigaBANBAUiAaCAtFAUCAaCApEA0GBaCAoEA0EBaKBoEA0EBSIBoIC0UBQIBoICkQDQYFoICgQDQQFojmXoF3T8/WX/uO/P4titc2LL0DXfPkRfN/v77YGkehpJZ+cMwnaf+Caa//H57vXr3Qg6C6cSdBu9HMwa8OvdHIFLYp+Ps4kaDu4o9rRa/96FPXjtX/xplb3av3nVRUZFo2aterVaIt6z8WJ9vLXu+0w2HXdUH58u42kU6u/30y76El8n6ccS/qrs67t53tzuQ3Hh67h+ZZI4FyCDp4pS6ygY6uqROjGVze9yMjcv/qbKtl//kbqMdrUHDvrOmfxFOmm+xXK3lE7T+IhrO2HGEE3qrOu7VgJJ/8zcCZBu6klMrb2svYOdENT1mlJegsuo8VKjsugYl+2HS19swFGfS53d52OMkR0IqnWbex+au08iTVOSlPcW511bZWgb3fbhr6ttv+QnElQ0ziptmwU1B689Ud+NUW7ZhJPffIvP0c1O9s0jUftdrFOR5lEHiMN6waPtKBbid2U0yBpXR1PbfvlfXH9fy30M3AmQe0x16ppFBhGNmZ4Yzy+2NWq7NDVa5w2eFRMvctd19n+oBtJGXPt05uc3sRj8ouJrgv5q+Oprc6p/w9BD8utaWZH5cu48Go+8uETvw5rzGpV9tasBLWKuescQZ1IWrzWHud9iQfclEZlX3U2awtBD4v90FrbpfQ1ZLqYMcxtQa+zcPMW1DncWkGdSMMxvh/0X+/xFtSmHF5vVMdTWwh6cNQgQk/RW0EXXcHhI9cDbv0Jz/ugl1m4VkdrF+scQd1I/ZIv/x6i+fqgzqTQsg+6UR1PbSHo0bET9XrUoj7g+WDatEn6wHpZjuJ7FfQQZEAvtSXMunkLaiNNM6W+Ubwj6HIUv1WddW0h6NFxphh1X3SaB9UH4alXNy7zzIO68+k2mLNu2Qc10VVCE9+ZB3USr+JOfVBPdda1haDHR49mTE/UtKHjhI07Lv7yo7Nnj15+tubY7E5Yzs4kTeuWo3gbyTS+szNJs8Q2cL98Por3VGddWwh6WlpZF20Iq05dIGiIdmhu++boEi+7A8KqswsQNISZ4BRy6YWw6uwCBA2iRz9ijqjCqrMHEBSIBoIC0UBQIBoICkQDQYFoICgQDQQFooGgQDQQFIgGggLRQFAgmklQcyXCNVAagJ0ZBZ1+VfP7+9PclAI8AVrQz/9znZz/BcADQR8UiAaCAtHMBDU/PARACkZQ9XOXj3+oe09hFA8EMQraqptdDK1nd6ofFADpjKN41W5+/DHcSwWTTEAQRlD1M//f/39HCwpkMR7iO9NualUBEIIZJHV6+H7DmU4gCsyDAtFAUCAaV9AO3U8gjUnQ9llu2AeeielMEssd0xoAkiAK2jLNfqJLC5KgClrYgtK/GODckAVl6oNCUJBEhqAso3jTis7+9XQ/vOtT399slEv/1wYqjLOMl1bP2PZS/12nTdyP0zuY6rMV3lM+2SiagAzhGu+f/jeOm0NPEikbTJpBMMvG0krJvWEjuQhVWX56TWAlS8qpoHmac9HVTCl5/dvkE3EjGmU/7COJIEG9O5IWIViyCf5JCEQt+Ps7x0CeUdDAUSB7hy4D1BU00ppVSr4OG01UIKj7d/mRLVSQ51L6pLzebQoeO3KyjAV9ZWs7ElxcPXns74QQoXLLTy9ve3JaUI4TSVyChuOwCcokyVaUPXJ7Dj0JtaAXseW2BKVtTkYfVF9QX0haXu+HROjNQNBQknifNB4jVGzZZM7/SSRH0Nf4IMk8GXKzDFHQxrcwHibzC+95f11BIwOWWsnpAxcGQYkbk3OIj59K6sxc/m1rUp+0pRC0TnLCnswqtWwyt3ZzeUa3YMIgyemmbv1yiSboZr8zFoayQ3eQRK6gxAYjrdTq09uYKynP6BZMGCQ5Dm/99pPStm0LGo0CQRNzcAq6jLqzoAmDJL4WVJfb7M0/jaAsx196cm8fnxokUGb16dE3JOcQ30QHSZ35SV1pH9Tbb+EW1NuPWC3hkESaoN4+PjlIoEhOr5OckFhwwFi8edKpRFDCF39PQZ1LMOjVeayg6fHpghbWvZKgjOE8/RbC955wSCoWNF6OIOg+rXcFQZfjhX0FNfObu1wsYkpWFnS7Pd4amwXDBIpR3CXlTsEfwtfHp0fZLlF8ZTq1Bf18T7rvItNE/VbR9C8+BA2HqC1occ3ph/jeveg8E9tE/UbRJjkGZYfyCErqaG6v21FQSnCyoKVk9UHbyOGdcZopVJmdBQ3HCoRJCvAgQanDmGMIqprI0L2Ztifq3av7C+AT1K2IYEEZPvZNQWmhU8eKXGQKqi4Z2W5Fq7eghCNTuFRwrBz7e2NlnqARI6sJSh3GRL/xpGjl+fwF1RgodJRnnKjffjuDoDQpEhvAownKEyYzXHE+X0H1qLnIBSN8E/Xbby8WdNV2xKRIG6A/UtBAB4rJHPmCtg3HzW8YZh9KBV2vyRe0IZeKrKR8OdalTixox/T8w3JBU9sUwgoeQUkpk2PQvo7RL182wgVNPZPUmV5AV3i53XZ1HiBoYrDM3h6DoM3qBe39lBSZ67nz5SVW9wn/fFc9gYcLStElW9DI4Tmy3LdarKCkraifLi+xnmYafkBfS9Dyisf7aaIETdpgCJr2tGMzUd9+/XVgQQkjDRZBIyMtkqC5fVhSjpzV3OlWBZOeF28n6ttLNUGTSXLKtzBd0GjXILzctz5L0Mb7MvntaQgX9K6nQZvwVKjRstf5uQRNWnhmQdk/1zqDJHsq6ff3hwua1up5FgoTNGGXQdAH5K2VKlPQJHMojba/AKH/u1FiWRqCVspbK1V86eEEDX29GPd3MBQE5UqVK2iKjhB0p2wVMz+PoMm9RcohGoKSA9qCO95+kYdMQTdrOPcgXaV9BQ3+VYR0QXe8gS0T6cNxsqC5rXMsNKHKW+tPK+jm7Zbq5GWA0BylCBpp6DYX1xY0eFA/kaApt75hzMsA5XgZle8e02hzxc6CBrukJUgXtCwdz4/miEkTl82XB2oY3YbTCsr/sZ5gFM8vaFbGpIBNqKgQQYNfXcY0xIhOwf4g//VXWzaWlypowvE7M2NtQVdr44O5TKQLevvyo/v66/O9yFAIGnojafC1uTJpxJeBcEHVPGgXuBSZOS8HnmTR/mNRBSHoHsk2Cqp5UCVo2WzT+QRNC9iEykLQlIKmBW2LnogoV9CwI1UypiaHoEkFdR+0i927gSkvB8HPbmPd0QQNN9qnElRP1SfdJpQhLwc0QfVKCErLVSMPKSItNecNbMshCjqsfZCg4W8Hse3aXdAKn2rGIOlP3XaGBkmsN7At52iC5ggQnjg4o6CBaab6t1+kQRVUrT6YoP41TXBtNpIFbaez6dsT9YxPmuNhlS0qaGH9IGj1XJsFTQsaQFoLSha0+OEU+YIGW28hgub0kblTleWufgNbIrsLSu9VuOUyRsnhcf+5BDUXhIbOJNW+gS2RZbZ4dnZBKTuaLmhk+bkEVXdcutw/Xo8zUZ8hKHfG5xI00mDvkClQUF3GdFMXixznVOehBA2O0CBovKAaon98+zn8t4msifrzCjquOJWgaoiuRvIhQYVN1B9M0EBRshi7Clpjt2b0QdUMffsWOsSLm2ZapjusoGQzKgnqjyhE0Ht7CdxXUVH9SXNkdhe0pNFmF3SvI68UQaOgBd1X0NgbIOgSaRP1EJQdX0wZgk43AQ8gbKJ+kW6P5JXGZWQvzieoka/siuWnF7RSSroXwYn/PSvClyep4Of7cX409xBB51nYUnoCPURQekXY0iQUVI0oWlBK0oqCRkKfT9CP18Ibh5HyMlGnOUtPCkH50kQKJhzb7Q3wtk92nkLQKRHjvC/5FEDx1deJ9djtexAt2DehkXH85tNn6HmZeIyg5kQOZ0Ly9ECtkyLkbwpPlrSCXfA5XsrQiMInEXQ4wDKno87pnlLQ6JH+Frmvw1kEraEHcVtOJ2gb7l0y52Wiyoj6QVC/bLW2t9K5iMyg7pmkwruKkPIy8UyCUjfmZILunLdCvsML6mzBI7cFglZKCEGZoA7XGHIwFHxIOFLC4wtqNmHvy2r9tdj4s0oOhoIPCUdK+ASCDtvwYD0haK2Ej/5cOWger+d9l8k7oqAJJzGZ83LxZILK2Ah5gir0VfK3Q13N9HyCikCkoOYsZtaNGx71ozkxA98no/7sXc5EvT6JeaCnfMwTQlA+JApqfrJ5oKd8zDNCUD7qd5yy+qCqCe0O1geFoFWofmDKmWYahvJF7ScEfRaq79XTzINC0Do0i39rxecr+JBwhIzwk5Vm9k+1+KSCR3sc9zwjBGVFoKCHexz3LCP8ZKax/6sXnlTwgI/jdjNCUGbECXrAx3G7KSEoM8296k7Nb0GPNlFf+6t+Whphgh7wcdxOSgjKTqUbQ9jo9IKHexz3lBJ+8iNP0F3z8qaEoBWoulPzLxbZKS8fdftKJ0aYoM4TEvbIywcEPSI5g6Tiey9S8vIBQY9ITgua8JskYU+aG3PCz+NRZ5Ak7UlzY04IejyqCCrvOUkPywkKyRFU3QM8OA8q70lzOvkDcoJCsn7yodrH0JkkoS0oOCD586Chnx2Le9IcOCr586DB2SZpT5oDR6VOC8qYF5ybKn3QlHAAJEEXND6KT9eUIcazBxJYJXmBmGPxB33iQAKrJC+QG+vzT912cpySl7el8gIJrJK8QHePoGU/mlsERaAdIj1xoClWO/VeGS4Llbel8gIJrJK8QHdPC8oaFIF2iPTEgZhj8Qd94kACqyQvkBPr4/VNTYVimmmvQAKrJC/QFOvj9arvEDq8YAqKQLtEeuJAU6xW3aC+VQP4NvLAbQD2RAs63DJMP0aB5adJADBhBL2OlkJQIApHUN39LLuaCQBenD7o8PwE87gkAEQwCnr78uPzXbWdLY7wQBJmRuA2XCb/8YoDPBAFLoEHooGgQDQQFIgGggLRQFAgGggKRMMk6Me3Yfq0a6br9fTjQqhX8C0C6TtFXMoDDb9ZHc5BlAW6jb87uGZcnLisUqfjlG+bfUEKNNxL8232tvWLzEC2jsVXcPII+vk+zO+3fV3M9Xq34fYjt37JjVDDZaCPP8b3lga69bX5fL+UB9LLMgKtIqkzd8Mz0EurNG0kJdDv733JrnG3ZP0iM5CtI3knrWAR9KZvaauvNtEn84cHf463K0m/gm8VyFy6UhpIv797+Vlco7uOQ66Rp0oXHaC0SouNTA00Xnrh7JL1i8xAto7knbSGQ9Bb8zaIpL8q+v/d138NZ6bGuucG6sZtKw1kW+LiGt3HXx8QA60jWUFLqzRtJLFK98Xb1i8yA9k65gRawNQHdXdZow/Nqg+qvaBcwbcI1P5dd29KA91e/npnCaSWDNcr0AMtI5lDfPG2mRcZVVLbYt+2fpEZyNYxJ9ACTkHH70u/z1XTrgSdNTwZgcYLWN6KA3XNcFS+FAe62+tmyYFWkcYBRGmV7IucKjVvnqa4NJCtY0agJZyCjr315mof+pm576dAZllpoO7LD55A9/lepws6RVINseotFFfJvMgIZIY2pYLOA9k6ShNU3f/h5a8/dY+v4BBvA+llfRNRGkh3gxgC3c38We4hftpJtsdXXCV3t1MC6RsaMhziF4FsHYUd4jUf3352ZrKQ3kmeBxpf/JHR/58H0n8xBDJH+Jz+/6JK+WMb7076Rh7bjA9tKR8kLQPZOgobJGnMXEybMc20DKQ38EafHVoG0vePZghkdnrODEqlbbMviIHMrWBLp5nWgWwdhUwzmerY+euBNmeifhlI/xz6rTxQZ74upYHsm+lz0MttG/ugpVWaIpICDannW5I3Ue8JZOooZaLeVEedmLS10V019+RnTqDWnA4sDXQzp+NKA9kDFjWQd9s4quTUjRBo7IcN397V+0sD2VaevJOW4GIRIBoICkQDQYFoICgQDQQFooGgQDQQFIgGggLRQFAgGggKRANBgWggKBANBAWigaBANBAUiAaCAtFAUCAaCApEA0GBaCAoEA0EBaKBoEA0EBSIBoIC0UBQIBoICkQDQYFoICgz+sE5jbpj5/v10ZV5AiBoBewjG0AxELQCEJQPCFoBLai6ae7H6z/V00XUY+70kw7GGy6CVCBoBVxBh6ewvfwcbivaDU87gKEUIGgFXEHfpgd/jc+vKblj+/mAoBVwBb3e7f/0vbDtEz9BChC0AluCTk9KBqlA0AoEW1BAAoJWYEPQT8zc04GgFdgQdBjFDw8uBMlA0ApsCTrMg2IQTwKCAtFAUCAaCApEA0GBaCAoEA0EBaKBoEA0EBSIBoIC0UBQIBoICkQDQYFoICgQDQQFooGgQDQQFIgGggLRQFAgGggKRANBgWggKBANBAWigaBANBAUiOZ/pGVSe2RJ+dIAAAAASUVORK5CYII=" alt /></p>
<div id="shortcut-using-the-reservoir-package" class="section level4">
<h4>Shortcut using the <code>reservoir</code> package</h4>
<p>The above analysis is already coded into the <code>Rippl</code> function of the <code>reservoir</code> package, with some helpful additions, such as a <code>double_cycle</code> option, as well as an output representing water spilled when the reservoir exceeds capacity. We use <code>install.packages(&quot;reservoir&quot;)</code> to obtain the package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>reservoir::<span class="kw">Rippl</span>(Q, <span class="dt">target =</span> R, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
<span class="kw">str</span>(x) <span class="co"># summarize output</span></code></pre></div>
<pre><code>## List of 3
##  $ No_fail_storage   : num 245
##  $ Storage_behavior  : Time-Series [1:71] from 1942 to 2012: 245 245 245 205 245 ...
##  $ Uncontrolled_spill: Time-Series [1:71] from 1942 to 2012: 36.5 16.9 0 31.4 30.1 ...</code></pre>
<p>The function returns a list of three objects: a number named <code>No_fail_storage</code>, and two time series objects, named <code>Storage_behavior</code>, and <code>Uncontolled_spill</code>. If we plot <code>Storage_behavior</code> we get the same as before, with the same no fail capacity of approximately 245 Mm^3:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x$Storage_behavior, <span class="dt">ylab =</span> <span class="st">&quot;Stored water (Mm^3)&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Storage behavior diagram&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
</div>
</div>
<div id="dealing-with-uncertainty" class="section level2">
<h2>Dealing with uncertainty</h2>
<p>One problem with the no-fail storage is that it is designed to avoid failure under an exact repeat of the recorded inflow data—typically 50 – 100 years in advanced countries like the US and often much shorter in other parts of the world. It may therefore be valuable to explore hydrological uncertainty capacity by re-examining the no-fail capacity under alternative plausible scenarios. A simple way of doing this is to develop a model of the inflow process, and then compute the no-fail storage under many realizations of that model to produce a <em>distribution</em> of the no-fail capacity.</p>
<div id="construct-a-model-of-the-process" class="section level3">
<h3>1. Construct a model of the process</h3>
<p>Constructing suitable time series models is a discipline in itself, and it is not the intention here to go into all the details. The time series we’re looking at here is actually very simple. The data are at annual resolution, and there is no significant autocorrelation (you can check this for yourself by plotting the correlogram: <code>acf(Q)</code>). In other words, the total inflow in a year is not influenced by the inflow in the previous year. This means we don’t need to account for the persistence of the streamflow in our model.</p>
<p>If the data were normally distributed, then all we would need to do to generate a realisation would be to find the parameters of the distribution (the mean and standard deviation of Q) and then randomly sample from that distribution using the <code>rnorm</code> function in the <code>stats</code> package (which is probably pre-loaded in your environment). However, streamflow data are usually positively skewed. We can check whether that is the case here by plotting the histogram and the quantile-quantile plot for the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Q)
<span class="kw">qqnorm</span>(Q); <span class="kw">qqline</span>(Q)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><img src="data:image/png;base64,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" alt /></p>
<p>The data are not too far from normal, but there is some positive skew. The Box-Cox transform is a popular and effective way of transforming to normal. It applies the following equation:</p>
<p><span class="math display">\[ Q_{trans} = (Q^\lambda  - 1) / \lambda \]</span></p>
<p>All we need to do is estimate the <span class="math inline">\(\lambda\)</span> parameter that gives the closest transform to the normal. The best thing about R is that we can nearly always find a package to do the work for us. Here we can use <code>AID</code>. Get the package by entering <code>install.packages(&quot;AID&quot;)</code>. We can then use the <code>boxcoxnc</code> function to fit the optimal value using a range of normality tests (type <code>?AID::boxcoxnc</code> to view the detail).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AID::<span class="kw">boxcoxnc</span>(Q, <span class="dt">plotit =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## $title
## [1] &quot;Implementation of Box-Cox Power Transformation when No Covariate Is Available&quot;
## 
## $method
## [1] &quot;All&quot;
## 
## $date
## [1] &quot;Wed Apr 06 22:07:03 2016&quot;
## 
## $result
##              sw   ad  cvm   pt   sf   lt   jb        ac
## lambda.hat 0.38 0.28 0.26 0.35 0.41 0.27 0.37 0.4016667
## sw.pvalue  1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.0000000
## sf.pvalue  1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.0000000
## jb.pvalue  1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.0000000</code></pre>
<p>We can see from these results that the appropriate <span class="math inline">\(\lambda\)</span> value is about 0.4. We can check this by generating <span class="math inline">\(Q_{trans}\)</span> and plotting the distribution:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Q_trans &lt;-<span class="st">  </span>(Q ^<span class="st"> </span><span class="fl">0.4</span> -<span class="st"> </span><span class="dv">1</span>) /<span class="st"> </span><span class="fl">0.4</span>
<span class="kw">hist</span>(Q_trans)
<span class="kw">qqnorm</span>(Q_trans); <span class="kw">qqline</span>(Q_trans)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><img src="data:image/png;base64,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" alt /></p>
<p>Results look reasonable, so we can now use the mean and standard deviation of the transformed data as parameters for our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(Q_trans)</code></pre></div>
<pre><code>## [1] 21.05393</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(Q_trans)</code></pre></div>
<pre><code>## [1] 3.170153</code></pre>
</div>
<div id="generate-synthetic-realisations" class="section level3">
<h3>2. Generate synthetic realisations</h3>
<p>We sample from the normal distribution to generate the realization and then simply reverse the transform to get back to the correct distribution:</p>
<p><span class="math display">\[Q = (\lambda \cdot Q_{trans} + 1)^{1/\lambda}\]</span></p>
<p>This is executed in R for 10,000 realization as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">realizations &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">71</span>, <span class="dt">ncol =</span> <span class="dv">10000</span>) <span class="co"># blank matrix with 10,000 columns</span>
for (i in <span class="dv">1</span>:<span class="dv">10000</span>){
  random_Q_trans &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">71</span>, <span class="dt">mean =</span> <span class="fl">21.05393</span>, <span class="dt">sd =</span> <span class="fl">3.170153</span>)
  realizations[,i] &lt;-<span class="st"> </span>(random_Q_trans*<span class="fl">0.4</span><span class="dv">+1</span>)^(<span class="dv">1</span>/<span class="fl">0.4</span>)
}</code></pre></div>
<p>If we want to make sure we have not made any mistakes, we can simple plot a few random realizations alongside the observed inflows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">as.vector</span>(Q), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Q (Mm^3)&quot;</span>)
<span class="kw">lines</span>(realizations[,<span class="dv">1</span>], <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">lines</span>(realizations[,<span class="dv">125</span>], <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">lines</span>(realizations[,<span class="dv">782</span>], <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
</div>
<div id="re-examine-the-design-storage" class="section level3">
<h3>3. Re-examine the design storage</h3>
<p>Now, we want to run the sequent peak algorithm on each realization and examine the distribution of no-fail storage for the proposed reservoir. The most intuitive way to do this would be to simply loop through each realization and run the sequent peak algorithm each time to get the no-fail capacity. A neater and more efficient way of doing the same thing is to use <code>apply</code> to compute the required function across the matrix of realizations. The first step is to create a simple function that returns just the no-fail storage for a given inflow sequence:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">get_no_fail_storage &lt;-<span class="st"> </span>function(x){
  no_fail &lt;-<span class="st"> </span>reservoir::<span class="kw">Rippl</span>(x, <span class="dt">target =</span> <span class="dv">250</span>, <span class="dt">double_cycle =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)$No_fail_storage
  <span class="kw">return</span>(no_fail)
}</code></pre></div>
<p>Next, we compute that function across all realizations using <code>apply</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">no_fail_storages &lt;-<span class="st"> </span><span class="kw">apply</span>(realizations, <span class="dv">2</span>, get_no_fail_storage) <span class="co"># may take a few seconds...</span>
<span class="kw">hist</span>(no_fail_storages, <span class="dt">main =</span> <span class="st">&quot;Distribution of no fail capacity&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;No fail capacity (Mm^3)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
<p>The result is interesting. First of all, we can see that the distribution of the no-fail storage is positively skewed, with a mean significantly larger than the no-fail storage calculated from the measured flow. This is due to the sensitivity of no-fail storage to changes in the inflow. A reduction in the mean of the inflow will cause relatively large increases in the required storage for no failure. Theoretically, the no-fail capacity should become infinte as the the required yield approaches the mean of the inflow <span class="math inline">\(Q\)</span> (yield greater than mean inflow cannot be sustained, so there would be a forever depleting reservoir). And the no fail storage for a yield of zero is also zero (we need no stored water to sustain a supply of zero). So the distribution is bounded on one side and unbounded on the other.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(no_fail_storages)</code></pre></div>
<pre><code>## [1] 344.8974</code></pre>
<p>The spread of the distribution this tells us is that there is that the uncertainty of the inflow process has a huge impact on the required design storage. A planner may look to design for a larger no-fail capacity than the 245 Mm^3 we obtained using the observed inflows. Interestingly, few planners in the 20th century extended their analysis in this way. This begs the question: why do more reservoirs not routinely fail when subjected to new inflows? The answer is that the system will normally have significant redundancy. For example, planners may use the no-fail storage and then add an additional 20%. And there is usually some provision to reduce the release, perhaps by imposing water acces restrictions or by augmenting demands from auxilliary supplies elsewhere. For this reason it is more common these days to use complex simulation models to design a reservoir or water resources system. But the no-fail storage remains very useful for rapid tests, theoretical understanding of reservoir storage behavior, and studies of reservoir behavior at a global scale.</p>
</div>
<div id="assessing-reservoir-spill" class="section level3">
<h3>Assessing reservoir spill</h3>
<p>One aspect that often goes overlooked is the impact of increased water withdrawal on flows apportioned to the downstream river system (we assume here that the water withdrawn for supply is abstracted directly from the reservoir and put into a distribution network rather than being released downstream). This should be quite intuitive. If we increase the storage to meet a higher yield, then we are implicitly allocating more of the water release to the supply—meaning less for the downstream river system. A simple way to investigate this would be to adjust the target release (required yield), re-run the sequent peak algorithm, and then compare the reservoir spill to the natural flows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spill_y250 &lt;-<span class="st"> </span>reservoir::<span class="kw">Rippl</span>(Q, <span class="dt">target =</span> <span class="dv">250</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)$Uncontrolled_spill
spill_y200 &lt;-<span class="st"> </span>reservoir::<span class="kw">Rippl</span>(Q, <span class="dt">target =</span> <span class="dv">200</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)$Uncontrolled_spill
spill_y150 &lt;-<span class="st"> </span>reservoir::<span class="kw">Rippl</span>(Q, <span class="dt">target =</span> <span class="dv">150</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)$Uncontrolled_spill

<span class="kw">plot</span>(Q, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Annual flow to river (Mm^3)&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;Impact of withdrawal on river flows downstream&quot;</span>)
<span class="kw">lines</span>(spill_y250, <span class="dt">lty =</span> <span class="dv">1</span>)
<span class="kw">lines</span>(spill_y200, <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">lines</span>(spill_y150, <span class="dt">lty =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
</div>
<div id="limitations-of-the-sequent-peak-analaysis-and-no-fail-storage" class="section level3">
<h3>Limitations of the sequent peak analaysis and no-fail storage</h3>
<p>…</p>
<hr />
<p><em>This tutorial was written in <a href="http://rmarkdown.rstudio.com/">Rmarkdown</a> inside <a href="http://www.rstudio.com/ide/">RStudio</a>. The raw Rmarkdown was converted to html and pdf using <a href="http://yihui.name/knitr/">knitr</a>.</em></p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>SUTD-MIT International Design Centre, Singapore University of Technology and Design, Singapore. Email: <a href="mailto:swd.turner@gmail.com">swd.turner@gmail.com</a><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Pillar of Engineering Systems and Design, Singapore University of Technology and Design, Singapore.<a href="#fnref2">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
